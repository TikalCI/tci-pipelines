@Library ("tci-library") _

import tci.multiJob.phase
import tci.multiJob.stepsBlock

pipeline {
    agent { label 'tci-jnlp-node' }
    options {
        timestamps()
        buildDiscarder(logRotator(numToKeepStr: '30'))
    }
    stages {
        stage("test") {
            steps {
                script {
                    def job_names=['test-tciGeneral',
                                   "test-tciBuildUser",
                                   "test-tciJobs",
                                   "test-tciGit",
                                   "test-tciEnv",
                                   "test-tciNotifications",
                                   "test-tciPython",
                                   "test-tciTemplatePipeline",
                                   "test-tciLogger",
                                   "test-tciSecurity",
                                   "test-mavenCIJob"]
                    def testPhase = new phase(this)

                    job_names.each { job ->
                        testPhase.addJob(jobName: job)
                    }
                    testPhase.run()
                }
            }
        }
    }
}
